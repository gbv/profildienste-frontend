<!-- -->
<div class="row title-box" ng-class="{selected: item.status.selected}" ng-controller="ItemController as ItemCtrl">
  <!-- Linke Seite -->
  <div class="col-md-2">
    <div class="row">
      <!-- Selektor -->
      <div class="col-md-4">
        <button type="button" class="btn btn-link pull-left xt-control xt-list" ng-hide="item.status.cart" ng-click="ItemCtrl.toggleSelect()">
          <i class="fa fa-square-o fa-2x" ng-hide="item.status.selected"></i>
          <i class="fa fa-check-square-o fa-2x" ng-show="item.status.selected"></i>
        </button>
      </div>
      <!-- Cover -->
      <div class="col-md-8">
        <img ng-show="item.hasCover" ng-src="{{item.cover_md}}" class="cover cover-lg" ng-click="ItemCtrl.showCover()">
        <img ng-hide="item.hasCover" ng-src="{{item.cover_md}}" class="cover">
      </div>
    </div>
  </div>
  <div class="col-md-7">
    <!-- Start Mitte -->
    <h2>{{item.titel}}</h2>
    <br>
    <h3>{{item.untertitel}}</h3>
    <br>
    <br>
    <span class="text-muted">von</span> {{item.verfasser}} <span class="text-muted">(</span> {{item.verlag}} <span class="text-muted">)</span>
    <br>
    <span class="text-muted">Umfang: </span> {{item.umfang}} 
    <span ng-show="item.format | notEmpty">
      <span class="text-muted">(</span>{{item.format}}<span class="text-muted">)</span>
    </span>
    <br>
    <br>
    <span class="text-muted">ISBN: </span> {{item.isbn}} <br>
    <br>
    <span class="text-muted">erscheint: </span> {{item.ersch_termin}} <br>
    <br>

    <span class="text-muted">GVK-Treffer: </span>{{item.mak}}
    <span ng-show="item.ilns | notEmpty">
      <span class="text-muted">(ILNs: </span>{{item.ilns}}
      <span ng-show="item.ppn">
        <span class="text-muted">, PPN: </span> {{item.ppn}}
      </span>
      <span class="text-muted">)</span>
    </span>

    <br>
    <br>
    
    <form class="form-inline">
      <!-- Lieferant -->
      <span class="text-muted">Lieferant: </span>
        <input type="text" pattern=".{7,}" title="Maximal 7 Zeichen" class="form-control input-sm lft" size="7" maxlength="7" ng-model="item.lft" ng-show="ItemCtrl.showInpField()">
      <span ng-hide="ItemCtrl.showInpField()">{{item.lft}}</span>

      <!-- Budget -->
      <span class="text-muted">Budget:</span>
      <select ng-show="ItemCtrl.showInpField()" ng-model="item.budget" class="form-control lft input-sm">
        <option ng-repeat="budget in budgets" ng-selected="budget.default" value="{{budget.key}}">{{budget.value}}</option>
      </select>
      <span ng-hide="ItemCtrl.showInpField()">{{item.budget}}</span>

      <!-- Selektionscode -->
      <span class="text-muted">Selektionscode: </span>
      <input type="text" pattern=".{20,}" title="Maximal 20 Zeichen" class="form-control input-sm lft" size="20" maxlength="20" ng-model="item.selcode" ng-show="ItemCtrl.showInpField()" placeholder="Selektionscode">
      <span ng-hide="ItemCtrl.showInpField()">{{item.selcode}}</span>

      <!-- SSG Nummer -->
      <span class="text-muted">SSGs-Nr.: </span>
      <input type="text" pattern=".{3,}" title="Maximal 3 Zeichen" class="form-control input-sm lft" size="3" maxlength="3" ng-model="item.ssgnr" ng-show="ItemCtrl.showInpField()" placeholder="SSG">
      <span ng-hide="ItemCtrl.showInpField()">{{item.ssgnr}}</span>

    </form>

    <div collapse="bibInfCollapsed">
        <br>
        <span class="text-muted">Erscheinungsjahr: </span> {{item.ersch_jahr}} <br><br>
        <span class="text-muted">Gattung: </span> {{item.gattung}} <br><br>
        <span class="text-muted">DNB-Nummer: </span> {{item.dnbnum}} <br>
        <span class="text-muted">WV: </span> {{item.wvdnb}} <br><br>
        <span class="text-muted">DNB Sachgruppe: </span> {{item.sachgruppe}} <br><br>
        <span class="text-muted">Zugeordnete Fachreferenten: </span>
        <span ng-repeat="person in item.zugeordnet">
          {{person}}{{$last ? '' : ', '}}
        </span>
        <br>
        <br>
    </div>

     <!-- Comments -->
     <div collapse="CommentCollapsed" ng-show="config.allowComments" ng-hide="item.status.cart">
       <br>
       <span class="text-muted">Kommentar: </span><br>
       <textarea class="form-control cmt-field" rows="3" ng-model="item.commentField" ng-blur="ItemCtrl.closeComment()" placeholder="Freitext-Kommentar"></textarea>
     </div>

     <br>
     <br>

     <div ng-show="item.status.cart">
       <span class="text-muted">Kommentar: </span> {{item.comment}}
     </div>

     <br>
     <br>

     <!-- Buttons -->
     <button type="button" ng-click="bibInfCollapsed = !bibInfCollapsed" class="btn btn-primary btn-sm add-bib-inf">
       <i class="fa fa-plus-square-o" ng-show="bibInfCollapsed"></i>
       <i class="fa fa-minus-square-o" ng-hide="bibInfCollapsed"></i>
       Zusätzliche Informationen
     </button>

     <button type="button"  ng-click="CommentCollapsed = false" ng-hide="item.status.cart" class="btn btn-primary btn-sm cmt-btn">
       <i class="fa fa-comment"></i> Kommentieren
     </button>

     <button type="button" class="btn btn-primary btn-sm btn-opac" ng-click="ItemCtrl.openOPAC()">
       <i class="fa fa-external-link"></i> OPAC Suche
     </button>

     <button type="button" class="btn btn-primary btn-sm add-inf" ng-show="item.addInfURL | notEmpty" ng-click="ItemCtrl.getAddInf()">
       <i class="fa fa-plus-square-o" ng-show="addInfCollapsed"></i>
       <i class="fa fa-minus-square-o" ng-hide="addInfCollapsed"></i>
       Verlagsmeldung
     </button>

     <br>
     <br>

     <div class="well well-lg" ng-bind-html="addInf" collapse="addInfCollapsed" ng-show="addInf | notEmpty"></div>
    <!-- End Mitte -->
  </div>
  <div class="col-md-3">
    <!-- Preisinformationen -->
    <div class="row" class="title-price">
      <div class="col-md-12">
        <span class="price" ng-bind-html="item.preis" ng-show="item.preis | notEmpty">{{item.preis}}</span>
        <span class="text-muted" ng-show="item.preis_kom | notEmpty">{{item.preis_kom}}</span>
      </div>
    </div>
    <!-- Button 1 -->
    <div class="row" class="title-button">
      <div class="col-md-12">

        <div class="btn-group pull-right" ng-show="ItemCtrl.showCartBtnRem()">
          <button type="button" class="btn btn-success add-cart" disabled="disabled">
            <i class="fa fa-check"></i> Im Warenkorb
          </button>
          <button type="button" class="btn btn-default rm-cart" ng-click="ItemCtrl.removeFromCart()">
            <i class="fa fa-times"></i>
          </button>
        </div>

        <div class="btn-group pull-right" ng-show="ItemCtrl.showCartBtn()">
          <button type="button" class="btn btn-success add-cart" ng-click="ItemCtrl.addToCart()">
            <i class="fa fa-shopping-cart"></i> Warenkorb
          </button>
        </div>

      </div>
    </div>
    <!-- Button 2 -->
    <div class="row" class="title-button">
      <div class="col-md-12">
        
        <span class="text-muted" ng-show="item.status.done">Sie haben diesen Titel bereits bestellt.</span>

        <div class="btn-group pull-right" ng-show="item.status.rejected">
          <button type="button" class="btn btn-danger rj-remove">
            <i class="fa fa-plus-circle"></i> Wieder aufnehmen
          </button>
        </div>

        <div class="btn-group pull-right" dropdown ng-hide="item.status.watchlist.watched">
          <button type="button" class="btn btn-warning" ng-click="ItemCtrl.addToWL(def_wl)"><i class="fa fa-star fa-lg"></i> Merkliste</button>
          <button type="button" class="btn btn-warning dropdown-toggle" dropdown-toggle>
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu pull-right">
            <li ng-repeat="wl in watchlists" ng-click="ItemCtrl.addToWL(wl.id)">
              <a href="#{{wl.id}}">{{wl.name}}</a>
            </li>
          </ul>
        </div>

        <div class="btn-group pull-right" ng-show="item.status.watchlist.watched">
          <button type="button" class="btn btn-warning add-watchlist disabled">
            <i class="fa fa-check"></i> In „ {{item.status.watchlist.name}} “
          </button>
          <button type="button" class="btn btn-default rm-watchlist" ng-click="ItemCtrl.removeFromWL()">
            <i class="fa fa-times"></i>
          </button>
        </div>

      </div>
    </div>
    <!-- Ablehnen Button -->
    <div class="row" class="title-button">
      <div class="col-md-12">
        <button type="button" class="btn btn-link pull-right xt-control xt-remove" ng-hide="item.status.cart">
          <i class="fa fa-minus-circle fa-lg"></i> Ablehnen
        </button>
      </div>
    </div>
  </div>
</div>